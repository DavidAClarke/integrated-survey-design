dplyr::select(usageKey.x, canonicalName, verbatim_name, acceptedUsageKey, status,
usageKey.y, ScientificName, dist)
View(taxon_df_diffs)
# #where dist != 0, do usage keys match?
taxon_df_diffs_nz <- taxon_df_diffs %>%
filter(dist != 0)
View(taxon_df_diffs_nz)
## Find differences in species name spelling
taxon_df_diffs <- taxon_df %>%
tidyr::drop_na(canonicalName) %>%
fuzzyjoin::stringdist_join(terrantalife, by = c(canonicalName = "ScientificName"),
mode = "inner", method = "lv", distance_col = "dist") %>%
dplyr::select(usageKey.x, canonicalName, verbatim_name, acceptedUsageKey, status,
usageKey.y, dist)
# #where dist != 0, do usage keys match?
taxon_df_diffs_nz <- taxon_df_diffs %>%
filter(dist != 0)
terrantalife_count_diff <-  terrantalife %>%
filter(keyCounts != nameCounts)
View(terrantalife_count_diff)
## Find differences in species name spelling
taxon_df_diffs <- taxon_df %>%
tidyr::drop_na(canonicalName) %>%
fuzzyjoin::stringdist_join(terrantalife, by = c(canonicalName = "ScientificName"),
mode = "inner", method = "lv", distance_col = "dist") %>%
dplyr::select(TaxonID, usageKey.x, canonicalName, verbatim_name, acceptedUsageKey, status,
usageKey.y, dist)
## Congruence between misspellings and count differences
terrantalife_count_diff2 <- terrantalife_count_diff %>%
left_join(taxon_df_diffs, by = "TaxonID")
View(terrantalife_count_diff2)
## Congruence between misspellings and count differences
terrantalife_count_diff2 <- terrantalife_count_diff %>%
left_join(taxon_df_diffs, by = "TaxonID") %>%
dplyr::select(TaxonID, usageKey.x, canonicalName, verbatim_name, acceptedUsageKey, status,
usageKey.y, dist, keyCounts, nameCounts)
View(terrantalife_count_diff2)
## Find differences in species name spelling
taxon_df_diffs <- taxon_df %>%
tidyr::drop_na(canonicalName) %>%
fuzzyjoin::stringdist_join(terrantalife, by = c(canonicalName = "ScientificName"),
mode = "inner", method = "lv", distance_col = "dist") %>%
dplyr::select(TaxonID, usageKey.x, canonicalName, verbatim_name,
ScientificName,acceptedUsageKey, status,usageKey.y, dist)
## Congruence between misspellings and count differences
terrantalife_count_diff2 <- terrantalife_count_diff %>%
left_join(taxon_df_diffs, by = "TaxonID") %>%
dplyr::select(TaxonID, usageKey.x, canonicalName, verbatim_name,
ScientificName, acceptedUsageKey, status,
usageKey.y, dist, keyCounts, nameCounts)
## Congruence between misspellings and count differences
terrantalife_count_diff2 <- terrantalife_count_diff %>%
left_join(taxon_df_diffs, by = "TaxonID") %>%
dplyr::select(TaxonID, usageKey.x, canonicalName, verbatim_name,
ScientificName, acceptedUsageKey, status,
usageKey.y, dist, keyCounts, nameCounts)
taxon_df_diffs
terrantalife_count_diff2 <- terrantalife_count_diff %>%
left_join(taxon_df_diffs, by = "TaxonID")
## Congruence between misspellings and count differences
terrantalife_count_diff2 <- terrantalife_count_diff %>%
left_join(taxon_df_diffs, by = "TaxonID") %>%
dplyr::select(TaxonID, usageKey.x, canonicalName, verbatim_name,
ScientificName.y, acceptedUsageKey, status,
usageKey.y, dist, keyCounts, nameCounts)
## Find differences in species name spelling
taxon_df_diffs <- taxon_df %>%
#tidyr::drop_na(canonicalName) %>%
fuzzyjoin::stringdist_join(terrantalife, by = c(canonicalName = "ScientificName"),
mode = "inner", method = "lv", distance_col = "dist") %>%
dplyr::select(TaxonID, usageKey.x, canonicalName, verbatim_name,
ScientificName,acceptedUsageKey, status,usageKey.y, dist)
View(taxon_df)
taxon_df_na
View(taxon_df_na)
## Species apparently not in GBIF
taxon_df_na <- taxon_df %>%
filter(is.na(canonicalName)) %>%
inner_join(terrantalife, by = c("verbatim_name" = "ScientificName"))
View(taxon_df_na)
## Species apparently not in GBIF
taxon_df_na <- taxon_df %>%
filter(is.na(canonicalName)) %>%
left_join(terrantalife, by = c("verbatim_name" = "ScientificName"))
View(taxon_df_na)
View(terrantalife)
rm(taxon_df_na)
## Species apparently not in GBIF
taxon_df_na <- taxon_df %>%
filter(is.na(canonicalName)) %>%
left_join(terrantalife, by = c("verbatim_name" = "ScientificName"))
View(terrantalife_count_diff)
## Of those, which have NA usageKeys and which don't
usage_na <- terrantalife_count_diff %>%
filter(is.na(usageKey))
usage_not_na <- terrantalife_count_diff %>%
filter(!is.na(usageKey))
View(usage_na)
View(usage_na)
## Species apparently not in GBIF
taxon_terr_df <- taxon_df %>%
left_join(terrantalife, by = c("verbatim_name" = "ScientificName"))
View(taxon_terr_df)
?stringdist
View(usage_na)
View(usage_na)
taxon_df_diffs %>% filter(ScientificName %in% usage_na$ScientificName)
dd <- taxon_df_diffs %>% filter(ScientificName %in% usage_na$ScientificName)
View(dd)
unique(taxon_df$verbatim_name)
tt <- taxon_df %>% distinct(verbatim_name = verbatim_name, .keep_all = T)
View(tt)
unique(tt$rank)
tt <- taxon_df %>% filter(rank != "PHYLUM" & rank != "KINGDOM") %>% distinct(verbatim_name = verbatim_name, .keep_all = T)
which(is.na(tt$canonicalName))
View(terrantalife)
rm(list=setdiff(ls(), "terrantalife", "taxon_df"))
rm(list=setdiff(ls(), c("terrantalife", "taxon_df")))
gc()
## Which species have count differences
terrantalife_count_diff <-  terrantalife %>%
filter(keyCounts != nameCounts)
View(taxon_df)
# Lepraria neglecta is a good example of their mistake
name_backbone("Lepraria neglecta", verbose = T)
View(terrantalife)
ln <- occ_search(scientificName = "Lepraria neglecta")
ln
ln <- occ_search(taxonKey = 6017317)
ln
gc()
suppressPackageStartupMessages(lapply(pkgs, require, character.only = T))
knitr::opts_chunk$set(echo = TRUE)
## Load required libraries
pkgs <- c("sf","tidyverse","here", "rgbif", "fuzzyjoin")
lapply(pkgs, require, character.only = T)
## Read in terrANTAlife data
shared_data <- "C:/Users/dcla0021/Documents/postdoc/projects/shared_data"
terrantalife <- read_csv(here(shared_data, "biodiversity", "terrANTAlife.csv")) %>%
dplyr::filter(taxonRank == "SPECIES") %>%
arrange(ScientificName)
head(terrantalife)
suppressPackageStartupMessages(lapply(pkgs, require, character.only = T))
foreach(i = 1:length(pkgs)) %dopar% {
suppressPackageStartupMessages(library(pkgs[i], character.only = TRUE))
# Perform other operations here
}
library(parallel)
library(foreach)
foreach(i = 1:length(pkgs)) %dopar% {
suppressPackageStartupMessages(library(pkgs[i], character.only = TRUE))
# Perform other operations here
}
## If you want o remove everything with excpetions from environment
rm(list=setdiff(ls(), c("terrantalife", "taxon_df")))
gc()
gc()
pkgs <- c("sf","tidyverse","here", "rgbif", "fuzzyjoin")
lapply(pkgs, require, character.only = T)
detach("package:foreach", unload = TRUE)
detach("package:parallel", unload = TRUE)
View(terrantalife)
shared_data <- "C:/Users/dcla0021/Documents/postdoc/projects/shared_data"
## Load required libraries
pkgs <- c("sf","tidyverse","here", "rgbif", "fuzzyjoin")
lapply(pkgs, require, character.only = T)
## Read in terrANTAlife data
terrantalife <- read_csv(here(shared_data, "biodiversity", "terrANTAlife.csv")) %>%
dplyr::filter(taxonRank == "SPECIES") %>%
arrange(ScientificName)
## Isolate vector of species names and taxon keys
species <- terrantalife %>% pull(ScientificName)
taxonKey <- terrantalife %>% pull(usageKey)
## Compare number of occurrences between key and names
key_counts <- c()
name_counts <- c()
# Searched on 07/06/2024
for(i in 1:length(taxonKey)){
gbif1 <- occ_count(taxonKey = taxonKey[i],
hasCoordinate = T,
hasGeospatialIssue = F)
key_counts <- c(key_counts, gbif1)
gbif2 <- occ_count(scientificName = species[i],
hasCoordinate = T,
hasGeospatialIssue = F)
name_counts <- c(name_counts, gbif2)
}
terrantalife <- terrantalife %>%
mutate(keyCounts = key_counts) %>%
mutate(nameCounts = name_counts)
write.csv(terrantalife, here("terrANTAlife_upd.csv"))
## Which species have count differences
terrantalife_count_diff <-  terrantalife %>%
filter(keyCounts != nameCounts)
head(terrantalife_count_diff)
terrantalife
terrantalife_count_diff
(terrantalife_count_diff <-  terrantalife %>%
filter(keyCounts != nameCounts))
install.packages("taxize")
library(taxize)
gnr_resolve("Lepraria neglecta")
w <- gnr_resolve("Lepraria neglecta")
View(w)
get_tsn("Lepraria neglecta")
get_gbifid_("Lepraria neglecta")
taxon_df <- data.frame()
for(i in 1:length(species)){
df <- name_backbone(name = species[i], verbose = T)
taxon_df <- taxon_df %>%
bind_rows(df)
}
taxon_terr_df <- taxon_df %>%
full_join(terrantalife, by = c("verbatim_name" = "ScientificName"))
View(taxon_terr_df)
View(terrantalife)
taxon_terr_df <- terrantalife %>%
full_join(taxon_df, by = c("ScientificName" = "verbatim_name"))
View(taxon_terr_df)
View(taxon_df)
## Species apparently not in GBIF
taxon_terr_df <- taxon_df %>%
dplyr::select(!c(kingdomKey, phylumKey, classKey, orderKey, familyKey,
genusKey, speciesKey)) %>%
left_join(terrantalife, by = c("verbatim_name" = "ScientificName"))
View(taxon_terr_df)
length(which(is.na(taxon_df$canonicalName)))
length(which(is.na(terrantalife$usageKey)))
taxon_df[taxon_df$canonicalName == NA,] == terrantalife[terrantalife$usageKey == NA,]
no_tax <- taxon_df %>%
no_tax <- taxon_df %>%
filter(is.na(canonicalName))
no_usage <- terrantalife %>%
filter(is.na(usageKey))
no_tax$verbatim_name == no_usage$ScientificName
taxon_terr_df %>%
filter(!(verbatim_name %in% no_usage$ScientificName)
taxon_terr_df %>%
filter(!(verbatim_name %in% no_usage$ScientificName))
taxon_terr_df_2 <- taxon_terr_df %>%
filter(!(verbatim_name %in% no_usage$ScientificName))
which(taxon_terr_df_2$keyCounts != taxon_terr_df_2$nameCounts)
count_diffs <- which(taxon_terr_df_2$keyCounts != taxon_terr_df_2$nameCounts)
length(count_diffs)
taxon_terr_df_2 %>% filter(is.na(canonicalName))
?stringdist
??stringdist
View(taxon_terr_df_2)
taxon_df_diffs <- taxon_df %>%
tidyr::drop_na(canonicalName) %>%
fuzzyjoin::stringdist_join(terrantalife, by = c(canonicalName = "ScientificName"),
mode = "inner", method = "lv", distance_col = "dist") %>%
dplyr::select(TaxonID, usageKey.x, canonicalName, verbatim_name,
ScientificName,acceptedUsageKey, status,usageKey.y, dist)
taxon_df_diffs <- taxon_df %>%
filter(canonicalName %in% taxon_terr_df_2$canonicalName) %>%
fuzzyjoin::stringdist_join(terrantalife, by = c(canonicalName = "ScientificName"),
mode = "inner", method = "lv", distance_col = "dist") %>%
dplyr::select(TaxonID, usageKey.x, canonicalName, verbatim_name,
ScientificName,acceptedUsageKey, status,usageKey.y, dist)
View(taxon_terr_df_2)
View(taxon_df_diffs)
## Find differences in species name spelling
taxon_df_diffs <- taxon_df %>%
tidyr::drop_na(canonicalName) %>%
fuzzyjoin::stringdist_join(terrantalife, by = c(canonicalName = "ScientificName"),
mode = "inner", method = "lv", distance_col = "dist") %>%
dplyr::select(TaxonID, usageKey.x, canonicalName, verbatim_name,
ScientificName,acceptedUsageKey, status,usageKey.y, dist,
keyCounts, nameCounts)
View(taxon_df_diffs)
## Find differences in species name spelling
taxon_df_diffs <- taxon_df %>%
tidyr::drop_na(canonicalName) %>%
fuzzyjoin::stringdist_join(terrantalife, by = c(canonicalName = "ScientificName"),
mode = "inner", method = "lv", distance_col = "dist") %>%
dplyr::select(TaxonID, usageKey.x, canonicalName, rank, verbatim_name,
ScientificName,acceptedUsageKey, status,usageKey.y, dist,
keyCounts, nameCounts)
View(taxon_df)
gg <- taxon_df_diffs %>% distinct(canonicalName = canonicalName, .keep_all = T)
View(gg)
taxon_terr_df_2[count_diffs,]
gg <- taxon_terr_df_2[count_diffs,]
gg %>% mutate(dist = stringdist::stringdist(canonicalName,verbatim_name))
taxon_terr_df_2 %>% row_number(count_diffs)
taxon_terr_df_2 %>% filter(row_number(count_diffs))
taxon_terr_df_2 %>% slice(count_diffs)
taxon_df_diffs <- taxon_terr_df_2 %>%
slice(count_diffs) %>%
mutate(dist = stringdist::stringdist(canonicalName, verbatim_name)) %>%
dplyr::select(TaxonID, usageKey.x, canonicalName, verbatim_name,
ScientificName,acceptedUsageKey, status,usageKey.y, dist)
View(taxon_terr_df_2)
taxon_df_diffs <- taxon_terr_df_2 %>%
slice(count_diffs) %>%
mutate(dist = stringdist::stringdist(canonicalName, verbatim_name)) %>%
dplyr::select(TaxonID, usageKey.x, canonicalName, verbatim_name,
acceptedUsageKey, status,usageKey.y, dist)
View(taxon_df_diffs)
taxon_df_diffs <- taxon_terr_df_2 %>%
slice(count_diffs) %>%
mutate(dist = stringdist::stringdist(canonicalName, verbatim_name)) %>%
dplyr::select(TaxonID, usageKey.x, canonicalName, verbatim_name,
acceptedUsageKey, status,usageKey.y, dist, keyCounts,
nameCounts)
unique(taxon_df_diffs$verbatim_name)
length(unique(taxon_df_diffs$verbatim_name))
knitr::opts_chunk$set(echo = TRUE)
plot(log1p(key_counts), log1p(name_counts))
write.csv(data.frame(key = key_counts, names = name_counts), here("counts.csv"), row.names = F)
## Load required libraries
pkgs <- c("sf","tidyverse","here", "rgbif", "fuzzyjoin")
lapply(pkgs, require, character.only = T)
here()
read.csv(here("counts.csv"))
cnts <- read.csv(here("counts.csv"))
plot(log1p(cnts$key_counts), log1p(cnts$name_counts))
View(cnts)
cnts <- read.csv(here("counts.csv"))
plot(log1p(cnts$key), log1p(cnts$names))
here()
taxon_df_diffs
taxon_terr_df_2 %>% group_by(verbatim_name, status) %>% count()
rr <- taxon_terr_df_2 %>% group_by(verbatim_name, status) %>% count()
View(rr)
rr <- taxon_terr_df_2 %>% group_by(verbatim_name, status) %>% count(status)
rr
taxon_terr_df_2 %>% filter(verbatim_name == "Achnanthes pinnata")
rr <- taxon_terr_df_2 %>% filter(match == "EXACT") %>% group_by(verbatim_name, status) %>% count(status)
rr
taxon_terr_df_2 %>% filter(verbatim_name == "Achnanthes pinnata")
rr <- taxon_terr_df_2 %>% filter(matchType == "EXACT") %>% group_by(verbatim_name, status) %>% count(status)
rr <- taxon_terr_df_2 %>% filter(matchType == "EXACT") %>% group_by(verbatim_name) %>% count(status)
rr2 <- rr %>% group_by(verbatim_name) %>% filter(n() > 1) %>%
ungroup
rr2
View(taxon_df)
tx <- taxon_df %>% filter(rank == "SPECIES") %>% distinct(verbatim_name = verbatim_name, .keep_all = T)
View(tx)
tx <- terrantalife %>%
dplyr::select(ScientificName, keyCounts, nameCounts) %>%
right_join(taxon_df, by = c("ScientificName" = "verbatim_name"))
tx <- terrantalife %>%
dplyr::select(ScientificName, keyCounts, nameCounts) %>%
right_join(taxon_df, by = c("verbatim_name" = "ScientificName" ))
tx <- terrantalife %>%
dplyr::select(usageKey, ScientificName, keyCounts, nameCounts) %>%
right_join(taxon_df, by = c("verbatim_name" = "ScientificName" ))
tx <- terrantalife %>%
dplyr::select(usageKey, ScientificName, keyCounts, nameCounts) %>%
right_join(taxon_df, by = c("ScientificName" = "verbatim_name"))
tx <- terrantalife %>%
dplyr::select(usageKey, ScientificName, keyCounts, nameCounts) %>%
right_join(taxon_df, by = c("ScientificName" = "verbatim_name")) %>%
mutate(dist = stringdist::stringdist(ScientificName, canonicalName))
tx <- terrantalife %>%
dplyr::select(usageKey, ScientificName, keyCounts, nameCounts) %>%
right_join(taxon_df, by = c("ScientificName" = "verbatim_name")) %>%
mutate(nameDist = stringdist::stringdist(ScientificName, canonicalName)) %>%
relocate(nameDist)
tx <- terrantalife %>%
dplyr::select(usageKey, ScientificName, keyCounts, nameCounts) %>%
right_join(taxon_df, by = c("ScientificName" = "verbatim_name")) %>%
mutate(nameDist = stringdist::stringdist(ScientificName, canonicalName)) %>%
relocate(canonicalName, .after = ScientificName) %>%
relocate(nameDist, .after = canonicalName) %>%
tx <- terrantalife %>%
dplyr::select(usageKey, ScientificName, keyCounts, nameCounts) %>%
right_join(taxon_df, by = c("ScientificName" = "verbatim_name")) %>%
mutate(nameDist = stringdist::stringdist(ScientificName, canonicalName)) %>%
relocate(canonicalName, .after = ScientificName) %>%
relocate(nameDist, .after = canonicalName)
tx <- terrantalife %>%
dplyr::select(usageKey, ScientificName, keyCounts, nameCounts) %>%
right_join(taxon_df, by = c("ScientificName" = "verbatim_name")) %>%
mutate(nameDist = stringdist::stringdist(ScientificName, canonicalName)) %>%
relocate(canonicalName, .after = ScientificName) %>%
relocate(nameDist, .after = canonicalName) %>%
relocate(usageKey.y, .after = ScientificName) %>%
relocate(status, matchType, .after = canonicalName)
View(tx)
View(tx)
tx2 <- tx %>% filter(nameDist == 0)
View(tx2)
tx3 <- tx2 %>% filter(usageKey.x == usageKey.y)
View(tx3)
tx3 <- tx2 %>% filter(usageKey.x != usageKey.y)
View(tx3)
tx3 <- tx2 %>% filter(keyCounts != nameCounts)
library(rgbif)
occ_count(taxonKey = 8523118)
occ_count(taxonKey = 11193967)
occ_count(taxonKey = 9383821)
occ_count(taxonKey = 7485766)
occ_count(scientificName = "Achnanthidium minutissimum")
occ_count(taxonKey = 7231611)
taxon_terr_df <- terrantalife %>%
dplyr::select(usageKey, ScientificName, keyCounts, nameCounts) %>%
right_join(taxon_df, by = c("ScientificName" = "verbatim_name")) %>%
mutate(nameDist = stringdist::stringdist(ScientificName, canonicalName)) %>%
relocate(canonicalName, .after = ScientificName) %>%
relocate(nameDist, .after = canonicalName) %>%
relocate(usageKey.y, .after = ScientificName) %>%
relocate(status, matchType, .after = canonicalName) %>%
relocate(acceptedNameUsage, .after = matchType)
taxon_terr_df <- terrantalife %>%
dplyr::select(usageKey, ScientificName, keyCounts, nameCounts) %>%
right_join(taxon_df, by = c("ScientificName" = "verbatim_name")) %>%
mutate(nameDist = stringdist::stringdist(ScientificName, canonicalName)) %>%
relocate(canonicalName, .after = ScientificName) %>%
relocate(nameDist, .after = canonicalName) %>%
relocate(usageKey.y, .after = ScientificName) %>%
relocate(status, matchType, .after = canonicalName) %>%
relocate(acceptedUsageKey, .after = matchType)
get_gbifid_("Achnanthes mollis")
tx <- taxon_terr_df %>% filter(keyCounts != nameCounts)
View(tx)
tx %>% filter(is.na(usageKey.x))
tx %>% distinct(ScientificName = ScientificName, .keep_all = T) %>% filter(is.na(usageKey.x))
tx %>% filter(!(is.na(usageKey.x)))
tx2 <- tx %>% filter(!(is.na(usageKey.x)))
View(tx2)
tx2 <- tx %>% filter(rank == "SPECIES") %>% filter(!(is.na(usageKey.x)))
tx2 <- tx %>% filter(rank == "SPECIES") %>% filter(!(is.na(usageKey.x))) %>% filter(status == "EXACT")
tx2 <- tx %>% filter(rank == "SPECIES") %>% filter(!(is.na(usageKey.x)))
tx2 <- tx %>% filter(rank == "SPECIES") %>% filter(!(is.na(usageKey.x))) %>% filter(matchType == "EXACT")
tx2 <- tx %>% filter(rank == "SPECIES") %>% filter(!(is.na(usageKey.y))) %>% filter(matchType == "EXACT")
View(terrantalife)
name_backbone("Petriophtydeus tilbrooki", verbose = T)
occ_count("Pretriophtydeus tilbrooki")
occ_count(scientificName = "Pretriophtydeus tilbrooki")
occ_count(scientificName = "Petriophtydeus tilbrooki")
occ_count(taxonKey = 6927034)
View(taxon_terr_df)
gc()
write.csv(taxon_df, here("taxon_df.csv"), row.names = F)
get_colid_("Adumbratosticha tetracirrata")
get_gbifid_("Adumbratosticha tetracirrata")
get_tsn_("Adumbratosticha tetracirrata")
get_bold_("Adumbratosticha tetracirrata")
get_eolid_(Adumbratosticha tetracirrata)
get_eolid_("Adumbratosticha tetracirrata")
as.eolid("Adumbratosticha tetracirrata")
occ_count(speciesKey = 52250864)
occ_count(speciesKey = 41022474)
occ_search(speciesKey = 41022474)
classification(41022474)
classification(41022474, db = "eol")
pkgs <- c("sf","tidyverse","here", "rgbif", "fuzzyjoin", "Stringdist")
lapply(pkgs, require, character.only = T)
## Read in terrANTAlife data
terrantalife <- read_csv(here(shared_data, "biodiversity", "terrANTAlife.csv")) %>%
dplyr::filter(taxonRank == "SPECIES") %>%
arrange(ScientificName)
shared_data <- "C:/Users/dcla0021/Documents/postdoc/projects/shared_data"
library(stringdist)
## Read in terrANTAlife data
terrantalife <- read_csv(here(shared_data, "biodiversity", "terrANTAlife.csv")) %>%
dplyr::filter(taxonRank == "SPECIES") %>%
arrange(ScientificName)
terrantalife <- read_csv(here("terrANTAlife_upd.csv"))
here()
terrantalife <- read_csv("C:/Users/dcla0021/Documents/postdoc/projects/sampling_plan/terrANTAlife_upd.csv")
terrantalife <- read_csv("C:/Users/dcla0021/Documents/postdoc/projects/sampling_plan/data/terrANTAlife_upd.csv")
taxon_df <- read_csv("C:/Users/dcla0021/Documents/postdoc/projects/sampling_plan/data/taxon_df.csv")
View(terrantalife)
plot(log1p(terrantalife$keyCounts), log1p(terrantalife$nameCounts))
(terrantalife_count_diff <-  terrantalife %>%
filter(keyCounts != nameCounts))
head(terrantalife_count_diff)
terrantalife_count_diff %>% dplyr::select(usageKey, ScientificName, keyCounts, nameCounts)
length(which(is.na(terrantalife$usageKey)))
43*2799162795
format(43*2799162795, scientific=F)
120 420 143 188 - 120364000185
120420143188 - 120364000185
taxon_df
taxon_terr_df <- terrantalife %>%
dplyr::select(usageKey, ScientificName, keyCounts, nameCounts) %>%
right_join(taxon_df, by = c("ScientificName" = "verbatim_name")) %>%
mutate(nameDist = stringdist::stringdist(ScientificName, canonicalName)) %>%
relocate(canonicalName, .after = ScientificName) %>%
relocate(nameDist, .after = canonicalName) %>%
relocate(usageKey.y, .after = ScientificName) %>%
relocate(status, matchType, .after = canonicalName) %>%
relocate(acceptedUsageKey, .after = matchType)
taxon_terr_df
gg <- taxon_terr_df %>% filter(nameDist > 0)
gg
taxon_terr_df %>% filter(ScientificName == "Achnanthes molli")
View(taxon_terr_df)
taxon_terr_df %>% filter(ScientificName == "Achnanthes mollis")
View(taxon_terr_df)
occ_count(2630696)
occ_count(taxonKey = 2630696)
which(taxon_terr_df$usageKey.x == 2630696)
name_backbone("Lepraria neglecta", verbose = T)
occ_count(taxonKey = 6017317)
taxon_terr_df %>% filter(ScientificName == "Paecilomyces variotti")
taxon_terr_df %>% filter(ScientificName == "Petriophtydeus tilbrooki")
q <- taxon_terr_df %>% filter(ScientificName == "Petriophtydeus tilbrooki")
View(q)
occ_count(taxonKey = 6927034)
q1 <- terrantalife %>% filter(ScientificName == "Petriophtydeus tilbrooki")
q2 <- taxon_df %>% filter(canonicalName == "Pretriophtydeus tilbrooki")
View(q2)
View(q1)
terrantalife %>% filter(usageKey < 100)
occ_count(taxonKey = 9383821)
q <- taxon_terr_df %>% filter(nameDist > 0)
View(q)
